# NUBI 마스터 플랜: 세션 연속성 + 환경 최적화

> **원본 출처:** `.cursor/plans/nubi_마스터_플랜_*.plan.md`
> **상태:** 전체 완료

## 핵심 컨셉: 2개 파일이 모든 것을 결정

```
.cursorrules        = AI의 "업무 매뉴얼" (어떻게 일할지)
docs/TASK.md        = AI의 "인수인계서" (무엇을 할지, 어디까지 했는지)
```

새 AI 세션이 시작되면: `.cursorrules` 읽기 -> `TASK.md` 읽기 -> 바로 작업 이어가기

---

## 1단계: `.cursorrules` 업데이트 — AI 작업 프로토콜 추가

기존 규칙은 유지하고, 아래 섹션을 **추가**합니다:

### 추가할 규칙들

**[세션 연속성 프로토콜]**

- 세션 시작 시 반드시 `docs/TASK.md`의 "현재 진행 상태" 섹션을 읽고 이어서 작업
- 작업 완료/중단 시 반드시 `docs/TASK.md`의 "현재 진행 상태" 섹션을 업데이트
- 중요한 로직/수식을 완성하면 반드시 코드 파일에 즉시 반영 (캔버스에만 두지 말 것)

**[파일 생성 절대 금지]**

- 캔버스(Canvas) 임시 파일 생성 금지
- `.plan.md` 파일 생성 금지
- 새로운 `.md` 파일 생성 금지
- 모든 기록은 기존 `docs/TASK.md`에 추가

**[자율 실행 + 보고 프로토콜]**

- Agent 모드에서 서브에이전트/스킬을 활용하여 자율 실행
- 각 작업 단계 완료 시 사용자에게 텍스트로 보고 (결과 + 다음 단계)
- 핵심 파일 수정 시에만 사용자 확인 요청

**[한국어 응답]**

- 모든 응답은 한국어
- 기술 용어는 쉽게 설명

---

## 2단계: `docs/TASK.md` 구조 개선 — 핸드오프 문서화

현재 TASK.md에 **"현재 진행 상태"** 섹션을 최상단에 추가합니다.

### 추가할 섹션 (TASK.md 최상단, 기존 내용 위에)

```markdown
## 0. 현재 진행 상태 (AI 핸드오프용)

> 이 섹션은 AI가 세션 시작 시 가장 먼저 읽는 인수인계 문서입니다.
> 매 세션 종료/중단 시 반드시 업데이트할 것.

**마지막 작업일:** 2026-02-07
**마지막 작업 내용:** [구체적 내용]
**다음 해야 할 작업:** [구체적 내용]
**주의사항:** [현재 알려진 이슈]
**환경 상태:** node_modules 미설치 - npm install 필요
```

기존 TASK.md의 섹션 1~11은 그대로 유지합니다.

---

## 3단계: Cursor 환경 최적화 — 멈춤 방지

### 3-1. `.cursorignore` 파일 생성

Cursor가 무시할 폴더/파일 지정 -> 인덱싱 부하 제거:

- `node_modules/`, `dist-server/`, `dist/`, `attached_assets/`, `.git/`

### 3-2. Cursor `settings.json` 최적화

- `files.watcherExclude`: 파일 변경 감시 제외
- `search.exclude`: 검색 제외
- `files.exclude`: 탐색기에서 숨기기

### 3-3. `.gitignore` 보완

- `dist-server/` 추가

### 3-4. `npm install` 실행

- 빠져있는 node_modules 복구

---

## 4단계: 기존 스코어링 로직 확인

`itinerary-generator.ts`에 현재 들어있는 수식들을 사용자에게 보여주고, 이전 캔버스에서 만든 로직과 일치하는지 확인받기:

- 식당 점수 (5요소 가중치)
- 한국인기 점수 (3요소 가중치)
- 바이브별 가중치 매트릭스 (6x6)
- 데이터 등급 보정 (A/B/C/D)
- 최종 6요소 정렬 공식

---

## 실행 순서 요약

| 순서 | 작업 | 소요 시간 | 상태 |
|------|------|----------|------|
| 1 | `.cursorrules` 업데이트 | 1분 | 완료 |
| 2 | `docs/TASK.md` 핸드오프 섹션 추가 | 1분 | 완료 |
| 3-1 | `.cursorignore` 생성 | 30초 | 완료 |
| 3-2 | Cursor settings.json 최적화 | 30초 | 완료 |
| 3-3 | `.gitignore` 보완 | 30초 | 완료 |
| 3-4 | `npm install` 실행 | 2-3분 | 완료 |
| 4 | 스코어링 로직 확인 보고 | 1분 | 완료 |

모든 작업은 **Agent 모드에서 자율 실행** 후 단계별 보고합니다.
