# ğŸ› ï¸ ê¸°ìˆ  ìš”êµ¬ ì‚¬í•­ ì •ì˜ì„œ (TRD: Technical Requirements Document)

## 1. ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜ (System Architecture)

> **í•µì‹¬ ì›ì¹™:** "Google MapsëŠ” ë„êµ¬(Canvas), GeminiëŠ” ì—”ì§„(Engine)"

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    í”„ë¡ íŠ¸ì—”ë“œ (Client Layer)                      â”‚
â”‚         React Native (Expo) + Google Maps SDK                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    API Gateway (Express)                         â”‚
â”‚              ì¸ì¦, ìš”ì²­ ë¶„ì‚°, ìºì‹±                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  Core Service Layer                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚Vibe Processorâ”‚ â”‚Buzz Calc   â”‚ â”‚Reality Checkâ”‚ â”‚Route Optim  â”‚â”‚
â”‚  â”‚(Gemini Vision)â”‚ â”‚(Reviews)   â”‚ â”‚(Weather/News)â”‚ â”‚(Distance)  â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Database Layer                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚  â”‚ PostgreSQL  â”‚ â”‚ Vector DB   â”‚ â”‚ Redis Cache â”‚                â”‚
â”‚  â”‚ (ì •í˜• ë°ì´í„°) â”‚ â”‚(ê°ì„± ê²€ìƒ‰)  â”‚ â”‚ (ìºì‹±)      â”‚                â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. ê¸°ìˆ  ìŠ¤íƒ (Tech Stack)

### A. í”„ë¡ íŠ¸ì—”ë“œ (Client Layer)

| í•­ëª© | ê¸°ìˆ  |
|------|------|
| **í”„ë ˆì„ì›Œí¬** | React Native (Expo) |
| **ë„¤ë¹„ê²Œì´ì…˜** | React Navigation 7+ |
| **ìƒíƒœê´€ë¦¬** | TanStack Query |
| **ì§€ë„** | Google Maps SDK (react-native-maps) |
| **UI** | iOS 26 Liquid Glass Design |

### B. ë°±ì—”ë“œ (Core Service Layer)

| í•­ëª© | ê¸°ìˆ  |
|------|------|
| **ëŸ°íƒ€ì„** | Node.js (Express) |
| **ì–¸ì–´** | TypeScript |
| **ORM** | Drizzle ORM |
| **AI** | Gemini 2.5 Flash (Vision + Text) |

### C. ë°ì´í„°ë² ì´ìŠ¤ (Database Layer)

| íƒ€ì… | ê¸°ìˆ  | ìš©ë„ |
|------|------|------|
| **RDBMS** | PostgreSQL (Supabase) | ì‚¬ìš©ì, ì˜ˆì•½, íŠ¸ëœì­ì…˜ |
| **Vector DB** | (í–¥í›„) Pinecone/Weaviate | ê°ì„± ê²€ìƒ‰ |
| **Cache** | (í–¥í›„) Redis | API ì‘ë‹µ ìºì‹± |

---

## 3. í•µì‹¬ ì„œë¹„ìŠ¤ ëª¨ë“ˆ

### A. Vibe Processor (Gemini Vision)

```typescript
// ì…ë ¥: ì¥ì†Œ ì‚¬ì§„ URL ë°°ì—´
// ì¶œë ¥: Vibe Score (0-10)
interface VibeAnalysis {
  visual_score: number;      // êµ¬ë„, ìƒ‰ê°, ì¡°ëª…
  composition: number;       // ì‚¬ì§„ êµ¬ì„±
  atmosphere: string[];      // ê°ì„± íƒœê·¸ (ëª½í™˜ì , í™í•œ, í´ë˜ì‹ ë“±)
  vibe_score: number;        // ìµœì¢… ì ìˆ˜
}
```

### B. Buzz Calculator

```typescript
// ë‹¤ì¤‘ ì†ŒìŠ¤ ì¸ê¸°ë„ ê³„ì‚°
interface BuzzScore {
  google_rating: number;
  tripadvisor_rating: number;
  review_volume: number;
  recency_weight: number;
  buzz_score: number;        // ìµœì¢… ì ìˆ˜
}
```

### C. Taste Verifier

```typescript
// ì˜¤ë¦¬ì§€ë„ ë§› ê²€ì¦
interface TasteVerification {
  cuisine_type: string;           // ìŒì‹ êµ­ì 
  originator_language: string;    // ë³¸ê³ ì¥ ì–¸ì–´
  originator_rating: number;      // ë³¸ê³ ì¥ ë¦¬ë·° í‰ì 
  expert_rating: number;          // ë¯¸ìŠë­/ì „ë¬¸ê°€ í‰ì 
  global_rating: number;          // ì „ì²´ í‰ì 
  taste_score: number;            // ìµœì¢… ì ìˆ˜
}
```

### D. Reality Checker

```typescript
// ì‹¤ì‹œê°„ í˜„ì‹¤ ì²´í¬
interface RealityCheck {
  weather_penalty: number;    // ë‚ ì”¨ íŒ¨ë„í‹° (0-2)
  safety_penalty: number;     // ì•ˆì „ íŒ¨ë„í‹° (0-2)
  crowd_penalty: number;      // í˜¼ì¡ë„ íŒ¨ë„í‹° (0-1)
  total_penalty: number;      // ì´ íŒ¨ë„í‹° (0-5)
}
```

### E. Route Optimizer

```typescript
// ë™ì„  ìµœì í™”
interface RouteOptimization {
  mode: 'budget' | 'comfort';     // ëŒ€ì¤‘êµí†µ vs íƒì‹œ
  total_distance: number;
  total_duration: number;
  total_cost: number;
  waypoints: Waypoint[];
}
```

---

## 4. API í†µí•© ì „ëµ

### ì™¸ë¶€ API

| API | ìš©ë„ | í•„ìˆ˜ ì—¬ë¶€ |
|-----|------|----------|
| **Google Places API** | ì¥ì†Œ ì •ë³´, ë¦¬ë·°, ì‚¬ì§„ | í•„ìˆ˜ |
| **Google Routes API** | ì´ë™ ì‹œê°„/ê±°ë¦¬ ê³„ì‚° | í•„ìˆ˜ |
| **OpenWeather API** | ë‚ ì”¨ ì •ë³´ | ì„ íƒ |
| **Gemini API** | AI ë¶„ì„ (Vision + Text) | í•„ìˆ˜ |

### ë‚´ë¶€ API ì—”ë“œí¬ì¸íŠ¸

```
GET  /api/cities                    - ë„ì‹œ ëª©ë¡
GET  /api/cities/:id/places         - ë„ì‹œ ë‚´ ì¥ì†Œ
GET  /api/cities/:id/recommendations - AI ì¶”ì²œ
POST /api/sync/city/:id/places      - Google Places ë™ê¸°í™”
POST /api/sync/city/:id/scores      - ì ìˆ˜ ê³„ì‚°
POST /api/routes/optimize           - ë™ì„  ìµœì í™”
GET  /api/health                    - í—¬ìŠ¤ ì²´í¬
```

---

## 5. ë°ì´í„° ì›Œí¬í”Œë¡œìš°

### ì›Œí¬í”Œë¡œìš° 1: ë°ì´í„° ìˆ˜ì§‘ ë° ì ìˆ˜í™” (ë°°ì¹˜)

```
1. Trigger: ë§¤ì¼/ì£¼ê°„ ë°°ì¹˜
2. Data Ingestion: Google Places â†’ ì¥ì†Œ/ë¦¬ë·°/ì‚¬ì§„ ìˆ˜ì§‘
3. AI Processing: Gemini Vision â†’ Vibe Score ì¶”ì¶œ
4. Scoring: Final Score ê³„ì‚° â†’ DB ì €ì¥
```

### ì›Œí¬í”Œë¡œìš° 2: ì‹¤ì‹œê°„ ì—¬ì • ìƒì„±

```
1. User Input: í”„ë¡œí•„, ì·¨í–¥, ëª©ì ì§€, ì¼ì •
2. Reality Check: ë‚ ì”¨/ì•ˆì „ API í˜¸ì¶œ
3. Filtering: Final Score ê¸°ì¤€ í•„í„°ë§
4. Optimization: ë™ì„  ìµœì í™”
5. Response: ìµœì¢… ì¼ì • ë°˜í™˜
```

---

## 6. ë°ì´í„° í¬ì†Œ ì§€ì—­ ëŒ€ì‘

| Tier | ì „ëµ |
|------|------|
| **Tier 1** (íŒŒë¦¬, ë„ì¿„) | ì „ì²´ ë¡œì§ 100% ê°€ë™ |
| **Tier 2** (ì¤‘ì†Œë„ì‹œ) | AI ì¶”ë¡ ìœ¼ë¡œ Vibe ì¶”ì • |
| **Tier 3** (ì†Œë„ì‹œ) | ê±°ë¦¬ë·°/ìœ„ì„±ì‚¬ì§„ ë¶„ì„ |

---

## 7. ë³´ì•ˆ ë° ê·œì • ì¤€ìˆ˜

- **ê°œì¸ì •ë³´:** GDPR(ìœ ëŸ½) ë° ê°œì¸ì •ë³´ë³´í˜¸ë²•(í•œêµ­) ì¤€ìˆ˜
- **ê²°ì œ ë³´ì•ˆ:** PCI-DSS ì¤€ìˆ˜ (PGì‚¬ ìœ„ì„ ì²˜ë¦¬)
- **API í‚¤ ê´€ë¦¬:** í™˜ê²½ ë³€ìˆ˜ë¡œ ê´€ë¦¬, í´ë¼ì´ì–¸íŠ¸ ë…¸ì¶œ ê¸ˆì§€
