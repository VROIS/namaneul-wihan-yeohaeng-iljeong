<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>VibeTrip ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ</title>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
      color: #fff;
      min-height: 100vh;
      padding: 20px;
    }
    .container { max-width: 1400px; margin: 0 auto; }
    
    header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 30px;
      padding: 20px 24px;
      background: rgba(255,255,255,0.05);
      border-radius: 16px;
      backdrop-filter: blur(10px);
    }
    .logo { display: flex; align-items: center; gap: 12px; }
    .logo h1 { font-size: 24px; font-weight: 700; }
    .logo span { color: #a78bfa; }
    .status-badge {
      padding: 8px 16px;
      border-radius: 20px;
      font-size: 14px;
      font-weight: 500;
    }
    .status-ok { background: rgba(34, 197, 94, 0.2); color: #22c55e; }
    .status-warn { background: rgba(245, 158, 11, 0.2); color: #f59e0b; }
    .status-error { background: rgba(239, 68, 68, 0.2); color: #ef4444; }
    
    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }
    
    .card {
      background: rgba(255,255,255,0.05);
      border-radius: 16px;
      padding: 24px;
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255,255,255,0.1);
    }
    .card h2 {
      font-size: 16px;
      color: #a78bfa;
      margin-bottom: 16px;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .card h2::before {
      content: '';
      width: 8px;
      height: 8px;
      background: #a78bfa;
      border-radius: 50%;
    }
    
    .stat-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 16px;
    }
    .stat-item {
      text-align: center;
      padding: 16px;
      background: rgba(255,255,255,0.03);
      border-radius: 12px;
    }
    .stat-value {
      font-size: 32px;
      font-weight: 700;
      color: #fff;
    }
    .stat-label {
      font-size: 12px;
      color: #9ca3af;
      margin-top: 4px;
    }
    
    .service-list { display: flex; flex-direction: column; gap: 12px; }
    .service-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 12px 16px;
      background: rgba(255,255,255,0.03);
      border-radius: 10px;
    }
    .service-name { font-size: 14px; }
    .service-status {
      width: 10px;
      height: 10px;
      border-radius: 50%;
    }
    .service-status.active { background: #22c55e; box-shadow: 0 0 8px #22c55e; }
    .service-status.inactive { background: #ef4444; }
    .service-status.pending { background: #f59e0b; }
    .service-status.unconfigured { background: #6b7280; }
    
    .freshness-bar {
      display: flex;
      height: 24px;
      border-radius: 12px;
      overflow: hidden;
      margin-bottom: 16px;
    }
    .freshness-segment { transition: width 0.3s ease; }
    .freshness-legend {
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
      font-size: 12px;
    }
    .legend-item {
      display: flex;
      align-items: center;
      gap: 6px;
    }
    .legend-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
    }
    
    .channel-list { display: flex; flex-direction: column; gap: 10px; max-height: 300px; overflow-y: auto; }
    .channel-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 10px 14px;
      background: rgba(255,255,255,0.03);
      border-radius: 8px;
    }
    .channel-info { display: flex; align-items: center; gap: 10px; }
    .channel-thumb {
      width: 32px;
      height: 32px;
      border-radius: 50%;
      background: rgba(255,255,255,0.1);
    }
    .channel-name { font-size: 14px; }
    .channel-category {
      font-size: 11px;
      color: #9ca3af;
      background: rgba(255,255,255,0.05);
      padding: 2px 8px;
      border-radius: 4px;
    }
    .trust-weight {
      font-size: 12px;
      padding: 4px 10px;
      background: linear-gradient(135deg, #6366f1, #a78bfa);
      border-radius: 12px;
    }
    
    .btn {
      padding: 10px 20px;
      border: none;
      border-radius: 8px;
      font-size: 14px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s;
    }
    .btn-primary {
      background: linear-gradient(135deg, #6366f1, #a78bfa);
      color: #fff;
    }
    .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 4px 12px rgba(99, 102, 241, 0.3); }
    .btn-secondary {
      background: rgba(255,255,255,0.1);
      color: #fff;
    }
    .btn-sm { padding: 6px 12px; font-size: 12px; }
    
    .add-form {
      display: none;
      padding: 16px;
      background: rgba(255,255,255,0.03);
      border-radius: 12px;
      margin-bottom: 16px;
    }
    .add-form.active { display: block; }
    .add-form input, .add-form select {
      width: 100%;
      padding: 10px 14px;
      border: 1px solid rgba(255,255,255,0.1);
      border-radius: 8px;
      background: rgba(255,255,255,0.05);
      color: #fff;
      margin-bottom: 10px;
      font-size: 14px;
    }
    .add-form input::placeholder { color: #6b7280; }
    
    .sync-logs { max-height: 200px; overflow-y: auto; }
    .log-item {
      display: flex;
      justify-content: space-between;
      padding: 8px 12px;
      border-bottom: 1px solid rgba(255,255,255,0.05);
      font-size: 13px;
    }
    .log-time { color: #6b7280; }
    .log-status { padding: 2px 8px; border-radius: 4px; font-size: 11px; }
    .log-status.success { background: rgba(34, 197, 94, 0.2); color: #22c55e; }
    .log-status.error { background: rgba(239, 68, 68, 0.2); color: #ef4444; }
    .log-status.pending { background: rgba(245, 158, 11, 0.2); color: #f59e0b; }
    
    .empty-state {
      text-align: center;
      padding: 40px;
      color: #6b7280;
    }
    
    .tabs {
      display: flex;
      gap: 8px;
      margin-bottom: 20px;
    }
    .tab {
      padding: 10px 20px;
      background: rgba(255,255,255,0.05);
      border: none;
      border-radius: 8px;
      color: #9ca3af;
      cursor: pointer;
      font-size: 14px;
      transition: all 0.2s;
    }
    .tab.active {
      background: linear-gradient(135deg, #6366f1, #a78bfa);
      color: #fff;
    }
    
    .loading { text-align: center; padding: 40px; color: #6b7280; }
    .spinner {
      width: 32px;
      height: 32px;
      border: 3px solid rgba(255,255,255,0.1);
      border-top-color: #a78bfa;
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin: 0 auto 16px;
    }
    @keyframes spin { to { transform: rotate(360deg); } }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div class="logo">
        <h1>Vibe<span>Trip</span></h1>
        <span style="color: #6b7280; font-size: 14px;">ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ</span>
      </div>
      <div style="display: flex; align-items: center; gap: 16px;">
        <span id="last-update" style="font-size: 12px; color: #6b7280;"></span>
        <div id="system-status" class="status-badge status-ok">ì‹œìŠ¤í…œ ì •ìƒ</div>
      </div>
    </header>
    
    <div class="tabs">
      <button class="tab active" data-tab="overview">í˜„í™©</button>
      <button class="tab" data-tab="sources">ë°ì´í„° ì†ŒìŠ¤</button>
      <button class="tab" data-tab="api">API ìƒíƒœ</button>
      <button class="tab" data-tab="logs">ë™ê¸°í™” ë¡œê·¸</button>
      <button class="tab" data-tab="guide-prices">ê°€ì´ë“œ ê°€ê²©</button>
    </div>
    
    <div id="tab-overview" class="tab-content">
      <div id="alerts-container" style="margin-bottom: 20px; display: none;">
        <div class="card" style="border: 1px solid rgba(245, 158, 11, 0.3); background: rgba(245, 158, 11, 0.05);">
          <h2 style="color: #f59e0b;">í’ˆì§ˆ ì•Œë¦¼</h2>
          <div id="quality-alerts" style="display: flex; flex-direction: column; gap: 8px;"></div>
        </div>
      </div>
      
      <div class="grid">
        <div class="card">
          <h2>ë°ì´í„° í˜„í™©</h2>
          <div class="stat-grid">
            <div class="stat-item">
              <div class="stat-value" id="stat-cities">-</div>
              <div class="stat-label">ë„ì‹œ</div>
            </div>
            <div class="stat-item">
              <div class="stat-value" id="stat-places">-</div>
              <div class="stat-label">ì¥ì†Œ</div>
            </div>
            <div class="stat-item">
              <div class="stat-value" id="stat-channels">-</div>
              <div class="stat-label">ìœ íŠœë¸Œ ì±„ë„</div>
            </div>
            <div class="stat-item">
              <div class="stat-value" id="stat-blogs">-</div>
              <div class="stat-label">ë¸”ë¡œê·¸ ì†ŒìŠ¤</div>
            </div>
          </div>
        </div>
        
        <div class="card">
          <h2>ìˆ˜ì§‘ í†µê³„</h2>
          <div class="stat-grid">
            <div class="stat-item">
              <div class="stat-value" id="stat-videos" style="color: #ff0000;">-</div>
              <div class="stat-label">YouTube ì˜ìƒ</div>
            </div>
            <div class="stat-item">
              <div class="stat-value" id="stat-blog-posts" style="color: #03c75a;">-</div>
              <div class="stat-label">ë¸”ë¡œê·¸ í¬ìŠ¤íŠ¸</div>
            </div>
            <div class="stat-item">
              <div class="stat-value" id="stat-place-mentions" style="color: #a78bfa;">-</div>
              <div class="stat-label">ì¥ì†Œ ì–¸ê¸‰</div>
            </div>
            <div class="stat-item">
              <div class="stat-value" id="stat-syncs-today" style="color: #22c55e;">-</div>
              <div class="stat-label">ì˜¤ëŠ˜ ë™ê¸°í™”</div>
            </div>
          </div>
        </div>
      </div>
      
      <div class="grid">
        <div class="card">
          <h2>ë°ì´í„° ì‹ ì„ ë„</h2>
          <div id="freshness-bar" class="freshness-bar"></div>
          <div id="freshness-legend" class="freshness-legend"></div>
        </div>
        
        <div class="card">
          <h2>ì£¼ê°„ ë™ê¸°í™” ì¶”ì´</h2>
          <div id="weekly-chart" style="display: flex; align-items: flex-end; justify-content: space-around; height: 100px; gap: 8px;"></div>
          <div id="weekly-labels" style="display: flex; justify-content: space-around; font-size: 11px; color: #6b7280; margin-top: 8px;"></div>
        </div>
      </div>
      
      <div class="grid">
        <div class="card">
          <h2>API ì„œë¹„ìŠ¤</h2>
          <div id="api-services" class="service-list">
            <div class="loading"><div class="spinner"></div>ë¡œë”© ì¤‘...</div>
          </div>
        </div>
        
        <div class="card">
          <h2>ìµœê·¼ ë™ê¸°í™”</h2>
          <div id="recent-syncs" class="sync-logs">
            <div class="loading"><div class="spinner"></div>ë¡œë”© ì¤‘...</div>
          </div>
        </div>
      </div>
    </div>
    
    <div id="tab-sources" class="tab-content" style="display: none;">
      <div class="card" style="margin-bottom: 20px;">
        <h2>ë°ì´í„° ì†ŒìŠ¤ í†µí•© í˜„í™©</h2>
        <p style="font-size: 12px; color: #9ca3af; margin-bottom: 16px;">ëª¨ë“  ë°ì´í„° ì†ŒìŠ¤ì˜ ìˆ˜ì§‘ í˜„í™©ì„ í•œëˆˆì— í™•ì¸í•˜ì„¸ìš”. ìë™ ìˆ˜ì§‘: ë§¤ì¼ 3AM KST</p>
        <div id="unified-sources" style="display: grid; gap: 12px;">
          <div class="source-row" style="display: grid; grid-template-columns: 2fr 1fr 1fr 1fr 1fr; gap: 12px; padding: 12px 16px; background: rgba(255,255,255,0.03); border-radius: 10px; align-items: center;">
            <div style="font-weight: 600; color: #a78bfa;">ì†ŒìŠ¤</div>
            <div style="text-align: center; font-weight: 600; color: #a78bfa;">ìƒíƒœ</div>
            <div style="text-align: center; font-weight: 600; color: #a78bfa;">ìˆ˜ì§‘ëŸ‰</div>
            <div style="text-align: center; font-weight: 600; color: #a78bfa;">ë§ˆì§€ë§‰ ë™ê¸°í™”</div>
            <div style="text-align: center; font-weight: 600; color: #a78bfa;">ì•¡ì…˜</div>
          </div>
          <div id="source-google" class="source-row" style="display: grid; grid-template-columns: 2fr 1fr 1fr 1fr 1fr; gap: 12px; padding: 12px 16px; background: rgba(255,255,255,0.03); border-radius: 10px; align-items: center;">
            <div><span style="color: #4285f4;">â—</span> Google Places</div>
            <div style="text-align: center;"><span id="google-status" class="status-badge status-ok">í™œì„±</span></div>
            <div style="text-align: center;" id="google-count">- ì¥ì†Œ</div>
            <div style="text-align: center; font-size: 12px;" id="google-sync">-</div>
            <div style="text-align: center;"><button class="btn btn-sm btn-secondary" onclick="syncGooglePlaces()">ë™ê¸°í™”</button></div>
          </div>
          <div id="source-instagram" class="source-row" style="display: grid; grid-template-columns: 2fr 1fr 1fr 1fr 1fr; gap: 12px; padding: 12px 16px; background: rgba(255,255,255,0.03); border-radius: 10px; align-items: center;">
            <div><span style="color: #e1306c;">â—</span> Instagram</div>
            <div style="text-align: center;"><span id="instagram-status" class="status-badge status-ok">í™œì„±</span></div>
            <div style="text-align: center;" id="instagram-count">- í•´ì‹œíƒœê·¸</div>
            <div style="text-align: center; font-size: 12px;" id="instagram-sync">-</div>
            <div style="text-align: center;"><button class="btn btn-sm btn-secondary" onclick="syncAllInstagram()">ë™ê¸°í™”</button></div>
          </div>
          <div id="source-youtube" class="source-row" style="display: grid; grid-template-columns: 2fr 1fr 1fr 1fr 1fr; gap: 12px; padding: 12px 16px; background: rgba(255,255,255,0.03); border-radius: 10px; align-items: center;">
            <div><span style="color: #ff0000;">â—</span> YouTube</div>
            <div style="text-align: center;"><span id="youtube-status" class="status-badge status-warn">ëŒ€ê¸°</span></div>
            <div style="text-align: center;" id="youtube-count">- ì±„ë„<br><small id="youtube-videos" style="color: #9ca3af;">- ì˜ìƒ</small><br><small id="youtube-places" style="color: #22c55e;">- ì¥ì†Œ</small></div>
            <div style="text-align: center; font-size: 12px;" id="youtube-sync">-</div>
            <div style="text-align: center;"><button class="btn btn-sm btn-secondary" onclick="syncYouTube()">ë™ê¸°í™”</button></div>
          </div>
          <div id="source-naver" class="source-row" style="display: grid; grid-template-columns: 2fr 1fr 1fr 1fr 1fr; gap: 12px; padding: 12px 16px; background: rgba(255,255,255,0.03); border-radius: 10px; align-items: center;">
            <div><span style="color: #03c75a;">â—</span> ë„¤ì´ë²„ ë¸”ë¡œê·¸</div>
            <div style="text-align: center;"><span id="naver-status" class="status-badge status-warn">ëŒ€ê¸°</span></div>
            <div style="text-align: center;" id="naver-count">- ì†ŒìŠ¤</div>
            <div style="text-align: center; font-size: 12px;" id="naver-sync">-</div>
            <div style="text-align: center;"><button class="btn btn-sm btn-secondary" onclick="syncNaverBlogs()">ë™ê¸°í™”</button></div>
          </div>
        </div>
      </div>
      
      <div class="grid">
        <div class="card">
          <h2>ìœ íŠœë¸Œ ì±„ë„</h2>
          <button class="btn btn-primary btn-sm" onclick="toggleForm('yt-form')" style="margin-bottom: 16px;">+ ì±„ë„ ì¶”ê°€</button>
          <div id="yt-form" class="add-form">
            <input type="text" id="yt-channel-id" placeholder="ì±„ë„ ID (ì˜ˆ: UC...)">
            <input type="text" id="yt-channel-name" placeholder="ì±„ë„ ì´ë¦„">
            <select id="yt-category">
              <option value="">ì¹´í…Œê³ ë¦¬ ì„ íƒ</option>
              <option value="food">ë§›ì§‘</option>
              <option value="travel">ì—¬í–‰</option>
              <option value="lifestyle">ë¼ì´í”„ìŠ¤íƒ€ì¼</option>
            </select>
            <input type="number" id="yt-trust" placeholder="ì‹ ë¢°ë„ ê°€ì¤‘ì¹˜ (0.1 - 2.0)" step="0.1" min="0.1" max="2">
            <button class="btn btn-primary" onclick="addYoutubeChannel()">ì¶”ê°€</button>
          </div>
          <div id="youtube-channels" class="channel-list">
            <div class="loading"><div class="spinner"></div>ë¡œë”© ì¤‘...</div>
          </div>
        </div>
        
        <div class="card">
          <h2>ë¸”ë¡œê·¸ ì†ŒìŠ¤</h2>
          <button class="btn btn-primary btn-sm" onclick="toggleForm('blog-form')" style="margin-bottom: 16px;">+ ì†ŒìŠ¤ ì¶”ê°€</button>
          <div id="blog-form" class="add-form">
            <select id="blog-platform">
              <option value="">í”Œë«í¼ ì„ íƒ</option>
              <option value="naver">ë„¤ì´ë²„ ë¸”ë¡œê·¸</option>
              <option value="tistory">í‹°ìŠ¤í† ë¦¬</option>
              <option value="michelin">ë¯¸ì‰ë¦° ê°€ì´ë“œ</option>
              <option value="tripadvisor">íŠ¸ë¦½ì–´ë“œë°”ì´ì €</option>
            </select>
            <input type="text" id="blog-name" placeholder="ì†ŒìŠ¤ ì´ë¦„">
            <input type="url" id="blog-url" placeholder="ì†ŒìŠ¤ URL">
            <input type="number" id="blog-trust" placeholder="ì‹ ë¢°ë„ ê°€ì¤‘ì¹˜ (0.1 - 2.0)" step="0.1" min="0.1" max="2">
            <button class="btn btn-primary" onclick="addBlogSource()">ì¶”ê°€</button>
          </div>
          <div id="blog-sources" class="channel-list">
            <div class="loading"><div class="spinner"></div>ë¡œë”© ì¤‘...</div>
          </div>
        </div>
      </div>
      
      <div class="grid" style="margin-top: 20px;">
        <div class="card">
          <h2>Instagram í•´ì‹œíƒœê·¸</h2>
          <div style="margin-bottom: 12px;">
            <button class="btn btn-sm btn-primary" onclick="toggleForm('hashtag-form-sources')">+ í•´ì‹œíƒœê·¸ ì¶”ê°€</button>
            <button class="btn btn-sm btn-secondary" onclick="seedInstagramData()">ê¸°ë³¸ ì¶”ê°€</button>
          </div>
          <div id="hashtag-form-sources" class="add-form">
            <input type="text" id="new-hashtag-sources" placeholder="#ì—í íƒ‘ (í•´ì‹œíƒœê·¸)">
            <select id="hashtag-category-sources">
              <option value="">ì¹´í…Œê³ ë¦¬</option>
              <option value="travel">ì—¬í–‰</option>
              <option value="food">ë§›ì§‘</option>
              <option value="cafe">ì¹´í˜</option>
              <option value="landmark">ëœë“œë§ˆí¬</option>
            </select>
            <button class="btn btn-primary" onclick="addHashtagFromSources()">ì¶”ê°€</button>
          </div>
          <div id="hashtag-list-sources" class="service-list" style="max-height: 250px; overflow-y: auto;">
            <div class="loading"><div class="spinner"></div>ë¡œë”© ì¤‘...</div>
          </div>
        </div>
        
        <div class="card">
          <h2>Instagram ìœ„ì¹˜ íƒœê·¸</h2>
          <div style="margin-bottom: 12px;">
            <button class="btn btn-sm btn-primary" onclick="toggleForm('location-form-sources')">+ ìœ„ì¹˜ ì¶”ê°€</button>
          </div>
          <div id="location-form-sources" class="add-form">
            <input type="text" id="new-location-id-sources" placeholder="Location ID">
            <input type="text" id="new-location-name-sources" placeholder="ìœ„ì¹˜ ì´ë¦„">
            <button class="btn btn-primary" onclick="addLocationFromSources()">ì¶”ê°€</button>
          </div>
          <div id="location-list-sources" class="service-list" style="max-height: 250px; overflow-y: auto;">
            <div class="loading"><div class="spinner"></div>ë¡œë”© ì¤‘...</div>
          </div>
        </div>
      </div>
    </div>
    
    <div id="tab-api" class="tab-content" style="display: none;">
      <div class="card">
        <h2>API ì„¤ì • ìƒíƒœ</h2>
        <div style="margin-bottom: 20px; display: flex; gap: 12px; flex-wrap: wrap;">
          <button class="btn btn-primary" onclick="initApiServices()">ì„œë¹„ìŠ¤ ì´ˆê¸°í™”</button>
          <button class="btn btn-secondary" onclick="seedDefaultData()">ê¸°ë³¸ ë°ì´í„° ì…ë ¥</button>
          <button class="btn btn-secondary" onclick="seedCities()">ê¸°ë³¸ ë„ì‹œ ì…ë ¥</button>
          <button class="btn btn-secondary" onclick="seedInstagramHashtags()">ê¸°ë³¸ í•´ì‹œíƒœê·¸ ì…ë ¥</button>
        </div>
        <div id="api-detail" class="service-list">
          <div class="loading"><div class="spinner"></div>ë¡œë”© ì¤‘...</div>
        </div>
      </div>
      
      <div class="card" style="margin-top: 20px;">
        <h2>ë°ì´í„° ìˆ˜ì§‘</h2>
        <div id="api-real-status" style="margin-bottom: 16px; font-size: 14px; color: #9ca3af;"></div>
        <div style="display: flex; gap: 12px; flex-wrap: wrap;">
          <button class="btn btn-primary" onclick="syncExchangeRates()">í™˜ìœ¨ ë™ê¸°í™”</button>
          <button class="btn btn-secondary" onclick="syncYouTube()">ìœ íŠœë¸Œ ë™ê¸°í™”</button>
          <button class="btn btn-secondary" onclick="syncPlaces()">ì¥ì†Œ ë™ê¸°í™” (ì„œìš¸)</button>
        </div>
        <div id="sync-result" style="margin-top: 16px; font-size: 14px;"></div>
      </div>
    </div>
    
    <div id="tab-logs" class="tab-content" style="display: none;">
      <div class="card">
        <h2>ë™ê¸°í™” íˆìŠ¤í† ë¦¬</h2>
        <div id="sync-history" class="sync-logs" style="max-height: 500px;">
          <div class="loading"><div class="spinner"></div>ë¡œë”© ì¤‘...</div>
        </div>
      </div>
    </div>

    <div id="tab-guide-prices" class="tab-content" style="display: none;">
      <div class="card">
        <h2>ê°€ì´ë“œ ê°€ê²© ê´€ë¦¬</h2>
        <p style="color: #9ca3af; font-size: 14px; margin-bottom: 20px;">35ë…„ì°¨ íŒŒë¦¬ ê°€ì´ë“œ í˜„ì¥ ë°ì´í„° ê¸°ë°˜ ê°€ê²©í‘œ (2026ë…„)</p>
        <div id="guide-prices-list" style="display: flex; flex-direction: column; gap: 12px;">
          <div class="loading"><div class="spinner"></div>ë¡œë”© ì¤‘...</div>
        </div>
      </div>
      
      <div id="guide-price-edit-modal" style="display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.7); z-index: 1000; align-items: center; justify-content: center;">
        <div class="card" style="width: 90%; max-width: 500px; margin: auto;">
          <h2>ê°€ê²© ìˆ˜ì •</h2>
          <form id="guide-price-form" style="display: flex; flex-direction: column; gap: 16px;">
            <input type="hidden" id="edit-price-id">
            <div>
              <label style="font-size: 12px; color: #9ca3af; display: block; margin-bottom: 4px;">ì„œë¹„ìŠ¤ëª…</label>
              <div id="edit-service-name" style="font-size: 16px; font-weight: 600;"></div>
            </div>
            <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 12px;">
              <div>
                <label style="font-size: 12px; color: #9ca3af; display: block; margin-bottom: 4px;">ê¸°ë³¸ ê°€ê²©</label>
                <input type="number" id="edit-price-per-day" class="form-input" placeholder="â‚¬">
              </div>
              <div>
                <label style="font-size: 12px; color: #9ca3af; display: block; margin-bottom: 4px;">ìµœì €ê°€</label>
                <input type="number" id="edit-price-low" class="form-input" placeholder="â‚¬">
              </div>
              <div>
                <label style="font-size: 12px; color: #9ca3af; display: block; margin-bottom: 4px;">ìµœê³ ê°€</label>
                <input type="number" id="edit-price-high" class="form-input" placeholder="â‚¬">
              </div>
            </div>
            <div>
              <label style="font-size: 12px; color: #9ca3af; display: block; margin-bottom: 4px;">ì„¤ëª…</label>
              <input type="text" id="edit-description" class="form-input" placeholder="ì„œë¹„ìŠ¤ ì„¤ëª…">
            </div>
            <div style="display: flex; gap: 12px; justify-content: flex-end; margin-top: 8px;">
              <button type="button" class="btn btn-secondary" onclick="closeEditModal()">ì·¨ì†Œ</button>
              <button type="submit" class="btn btn-primary">ì €ì¥</button>
            </div>
          </form>
        </div>
      </div>
    </div>

  </div>
  
  <script>
    const API_BASE = '/api/admin';
    
    const STATUS_MAP = {
      'success': 'ì„±ê³µ',
      'error': 'ì˜¤ë¥˜',
      'pending': 'ì§„í–‰ì¤‘',
      'partial': 'ë¶€ë¶„ì„±ê³µ'
    };
    
    const SERVICE_MAP = {
      'Google Places API': 'Google Places API',
      'Google Maps API': 'Google Maps API',
      'OpenWeather API': 'OpenWeather API',
      'YouTube Data API': 'YouTube Data API',
      'Exchange Rate API': 'í™˜ìœ¨ API',
      'Gemini AI': 'Gemini AI'
    };
    
    document.querySelectorAll('.tab').forEach(tab => {
      tab.addEventListener('click', () => {
        document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
        document.querySelectorAll('.tab-content').forEach(c => c.style.display = 'none');
        tab.classList.add('active');
        document.getElementById(`tab-${tab.dataset.tab}`).style.display = 'block';
        loadTabData(tab.dataset.tab);
      });
    });
    
    async function loadTabData(tab) {
      switch(tab) {
        case 'overview': loadDashboard(); break;
        case 'sources': loadSources(); loadUnifiedSourcesStatus(); break;
        case 'api': loadApiDetail(); loadApiRealStatus(); break;
        case 'logs': loadLogs(); break;
        case 'guide-prices': loadGuidePrices(); break;
      }
    }
    
    async function loadDashboard() {
      try {
        const [dashRes, freshnessRes, statsRes, alertsRes] = await Promise.all([
          fetch(`${API_BASE}/dashboard`),
          fetch(`${API_BASE}/data-freshness`),
          fetch(`${API_BASE}/collection-stats`),
          fetch(`${API_BASE}/data-quality/alerts`)
        ]);
        const dash = await dashRes.json();
        const freshness = await freshnessRes.json();
        const stats = await statsRes.json();
        const alertsData = await alertsRes.json();
        
        document.getElementById('stat-cities').textContent = dash.overview.cities;
        document.getElementById('stat-places').textContent = dash.overview.places;
        document.getElementById('stat-channels').textContent = dash.overview.youtubeChannels;
        document.getElementById('stat-blogs').textContent = dash.overview.blogSources;
        
        document.getElementById('stat-videos').textContent = stats.totals.youtubeVideos;
        document.getElementById('stat-blog-posts').textContent = stats.totals.blogPosts;
        document.getElementById('stat-place-mentions').textContent = stats.totals.placeMentions;
        document.getElementById('stat-syncs-today').textContent = stats.syncs.today;
        
        const alertsContainer = document.getElementById('alerts-container');
        const alertsEl = document.getElementById('quality-alerts');
        if (alertsData.alerts && alertsData.alerts.length > 0) {
          alertsContainer.style.display = 'block';
          alertsEl.innerHTML = alertsData.alerts.map(a => {
            const iconMap = { error: 'ğŸ”´', warning: 'ğŸŸ¡', info: 'ğŸ”µ' };
            return `<div style="display: flex; justify-content: space-between; align-items: center; padding: 8px 12px; background: rgba(255,255,255,0.03); border-radius: 8px;">
              <span>${iconMap[a.severity] || ''} ${a.message}</span>
              <span style="font-size: 12px; color: #9ca3af;">${a.action || ''}</span>
            </div>`;
          }).join('');
        } else {
          alertsContainer.style.display = 'none';
        }
        
        const chartEl = document.getElementById('weekly-chart');
        const labelsEl = document.getElementById('weekly-labels');
        if (stats.dailyStats && stats.dailyStats.length > 0) {
          const maxTotal = Math.max(...stats.dailyStats.map(d => d.total || 1));
          chartEl.innerHTML = stats.dailyStats.map(d => {
            const height = Math.max(10, (d.total / maxTotal) * 80);
            const successPct = d.total > 0 ? (d.success / d.total) * 100 : 100;
            return `<div style="display: flex; flex-direction: column; align-items: center; gap: 4px;">
              <div style="width: 24px; height: ${height}px; background: linear-gradient(to top, #22c55e ${successPct}%, #ef4444 ${successPct}%); border-radius: 4px;" title="ì„±ê³µ: ${d.success}, ì‹¤íŒ¨: ${d.failed}"></div>
              <span style="font-size: 10px; color: #9ca3af;">${d.total}</span>
            </div>`;
          }).join('');
          labelsEl.innerHTML = stats.dailyStats.map(d => {
            const date = new Date(d.date);
            return `<span>${date.getMonth()+1}/${date.getDate()}</span>`;
          }).join('');
        }
        
        const bar = document.getElementById('freshness-bar');
        const legend = document.getElementById('freshness-legend');
        const total = freshness.total || 1;
        const { summary } = freshness;
        
        bar.innerHTML = Object.entries(summary).map(([key, val]) => 
          `<div class="freshness-segment" style="width: ${(val.count/total)*100}%; background: ${val.color}"></div>`
        ).join('');
        
        legend.innerHTML = Object.entries(summary).map(([key, val]) =>
          `<div class="legend-item"><span class="legend-dot" style="background: ${val.color}"></span>${val.label}: ${val.count}</div>`
        ).join('');
        
        // ì‹¤ì‹œê°„ API ì—°ê²° ìƒíƒœ í™•ì¸ (ì‹¤ì œ ping)
        const servicesEl = document.getElementById('api-services');
        servicesEl.innerHTML = '<div style="text-align: center; padding: 12px; color: #f59e0b;">ì—°ê²° í™•ì¸ ì¤‘...</div>';
        
        const healthRes = await fetch(`${API_BASE}/api-services/health`);
        const healthData = await healthRes.json();
        
        const serviceNames = {
          'google_places': 'Google Places API',
          'google_maps': 'Google Maps API',
          'openweather': 'OpenWeather API',
          'youtube_data': 'YouTube Data API',
          'exchange_rate': 'Exchange Rate API',
          'gemini': 'Gemini AI'
        };
        
        const services = Object.entries(healthData.services || {}).map(([name, health]) => ({
          serviceName: name,
          displayName: serviceNames[name] || name,
          isConnected: health.connected,
          latency: health.latency,
          error: health.error
        }));
        
        updateSystemStatusFromHealth(services);
        
        servicesEl.innerHTML = services.length ? services.map(s => {
          const statusClass = s.isConnected ? 'active' : (s.error === 'API key not configured' ? 'unconfigured' : 'inactive');
          const tooltip = s.isConnected ? `ì—°ê²°ë¨ (${s.latency}ms)` : (s.error || 'ì—°ê²° ì‹¤íŒ¨');
          return `
            <div class="service-item" title="${tooltip}">
              <span class="service-name">${s.displayName}</span>
              <span class="service-status ${statusClass}"></span>
            </div>
          `;
        }).join('') : '<div class="empty-state">ì„œë¹„ìŠ¤ê°€ ì„¤ì •ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. <a href="#" onclick="initApiServices()">ì´ˆê¸°í™”í•˜ê¸°</a></div>';
        
        const syncsEl = document.getElementById('recent-syncs');
        syncsEl.innerHTML = dash.recentSyncs.length ? dash.recentSyncs.map(s => `
          <div class="log-item">
            <span>${s.entityType}</span>
            <span class="log-status ${s.status}">${STATUS_MAP[s.status] || s.status}</span>
            <span class="log-time">${new Date(s.startedAt).toLocaleString('ko-KR')}</span>
          </div>
        `).join('') : '<div class="empty-state">ìµœê·¼ ë™ê¸°í™” ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤</div>';
        
      } catch (err) {
        console.error('ëŒ€ì‹œë³´ë“œ ë¡œë“œ ì˜¤ë¥˜:', err);
        updateSystemStatus([]);
      }
    }
    
    function getServiceStatusClass(service) {
      if (!service.isConfigured) {
        return 'unconfigured';
      }
      if (service.healthStatus) {
        switch (service.healthStatus.status) {
          case 'healthy': return 'active';
          case 'warning': return 'pending';
          case 'error': return 'inactive';
          case 'unknown': return 'unconfigured';
          default: return 'unconfigured';
        }
      }
      return 'active';
    }
    
    function updateSystemStatus(services) {
      const statusEl = document.getElementById('system-status');
      
      if (!services || services.length === 0) {
        statusEl.textContent = 'ì—°ê²° ì˜¤ë¥˜';
        statusEl.className = 'status-badge status-error';
        return;
      }
      
      const hasError = services.some(s => s.healthStatus?.status === 'error');
      const hasWarning = services.some(s => s.healthStatus?.status === 'warning');
      const hasUnconfigured = services.some(s => !s.isConfigured);
      
      if (hasError) {
        statusEl.textContent = 'ì˜¤ë¥˜ ë°œìƒ';
        statusEl.className = 'status-badge status-error';
      } else if (hasWarning) {
        statusEl.textContent = 'ì£¼ì˜ í•„ìš”';
        statusEl.className = 'status-badge status-warn';
      } else if (hasUnconfigured) {
        statusEl.textContent = 'ì¼ë¶€ ë¯¸ì—°ê²°';
        statusEl.className = 'status-badge status-warn';
      } else {
        statusEl.textContent = 'ì‹œìŠ¤í…œ ì •ìƒ';
        statusEl.className = 'status-badge status-ok';
      }
    }
    
    function updateSystemStatusFromHealth(services) {
      const statusEl = document.getElementById('system-status');
      
      if (!services || services.length === 0) {
        statusEl.textContent = 'ì—°ê²° ì˜¤ë¥˜';
        statusEl.className = 'status-badge status-error';
        return;
      }
      
      const connectedCount = services.filter(s => s.isConnected).length;
      const unconfiguredCount = services.filter(s => s.error === 'API key not configured').length;
      const errorCount = services.filter(s => !s.isConnected && s.error !== 'API key not configured').length;
      
      if (errorCount > 0) {
        statusEl.textContent = `ì—°ê²° ì˜¤ë¥˜ (${errorCount}ê°œ)`;
        statusEl.className = 'status-badge status-error';
      } else if (unconfiguredCount > 0) {
        statusEl.textContent = `ì¼ë¶€ ë¯¸ì„¤ì • (${unconfiguredCount}ê°œ)`;
        statusEl.className = 'status-badge status-warn';
      } else {
        statusEl.textContent = `ëª¨ë‘ ì—°ê²°ë¨ (${connectedCount}ê°œ)`;
        statusEl.className = 'status-badge status-ok';
      }
    }
    
    async function loadSources() {
      try {
        const [ytRes, blogRes] = await Promise.all([
          fetch(`${API_BASE}/youtube-channels`),
          fetch(`${API_BASE}/blog-sources`)
        ]);
        const channels = await ytRes.json();
        const blogs = await blogRes.json();
        
        const CATEGORY_MAP = {
          'food': 'ë§›ì§‘',
          'travel': 'ì—¬í–‰',
          'lifestyle': 'ë¼ì´í”„ìŠ¤íƒ€ì¼',
          'Uncategorized': 'ë¯¸ë¶„ë¥˜'
        };
        
        const ytEl = document.getElementById('youtube-channels');
        ytEl.innerHTML = channels.length ? channels.map(c => `
          <div class="channel-item">
            <div class="channel-info">
              <div class="channel-thumb"></div>
              <div>
                <div class="channel-name">${c.channelName}</div>
                <span class="channel-category">${CATEGORY_MAP[c.category] || c.category || 'ë¯¸ë¶„ë¥˜'}</span>
              </div>
            </div>
            <span class="trust-weight">${c.trustWeight.toFixed(1)}</span>
          </div>
        `).join('') : '<div class="empty-state">ë“±ë¡ëœ ì±„ë„ì´ ì—†ìŠµë‹ˆë‹¤</div>';
        
        const PLATFORM_MAP = {
          'naver': 'ë„¤ì´ë²„ ë¸”ë¡œê·¸',
          'tistory': 'í‹°ìŠ¤í† ë¦¬',
          'michelin': 'ë¯¸ì‰ë¦° ê°€ì´ë“œ',
          'tripadvisor': 'íŠ¸ë¦½ì–´ë“œë°”ì´ì €'
        };
        
        const blogEl = document.getElementById('blog-sources');
        blogEl.innerHTML = blogs.length ? blogs.map(b => `
          <div class="channel-item">
            <div class="channel-info">
              <div>
                <div class="channel-name">${b.sourceName}</div>
                <span class="channel-category">${PLATFORM_MAP[b.platform] || b.platform}</span>
              </div>
            </div>
            <span class="trust-weight">${b.trustWeight.toFixed(1)}</span>
          </div>
        `).join('') : '<div class="empty-state">ë“±ë¡ëœ ë¸”ë¡œê·¸ ì†ŒìŠ¤ê°€ ì—†ìŠµë‹ˆë‹¤</div>';
        
      } catch (err) {
        console.error('ì†ŒìŠ¤ ë¡œë“œ ì˜¤ë¥˜:', err);
      }
    }
    
    async function loadUnifiedSourcesStatus() {
      try {
        const res = await fetch(`${API_BASE}/data-sources/status`);
        const data = await res.json();
        
        // Google Places
        document.getElementById('google-count').textContent = `${data.google?.count || 0} ì¥ì†Œ`;
        document.getElementById('google-sync').textContent = data.google?.lastSync || '-';
        document.getElementById('google-status').textContent = data.google?.status || 'ëŒ€ê¸°';
        document.getElementById('google-status').className = `status-badge ${data.google?.status === 'í™œì„±' ? 'status-ok' : 'status-warn'}`;
        
        // Instagram
        document.getElementById('instagram-count').textContent = `${data.instagram?.count || 0} í•´ì‹œíƒœê·¸`;
        document.getElementById('instagram-sync').textContent = data.instagram?.lastSync || '-';
        document.getElementById('instagram-status').textContent = data.instagram?.status || 'ëŒ€ê¸°';
        document.getElementById('instagram-status').className = `status-badge ${data.instagram?.status === 'í™œì„±' ? 'status-ok' : 'status-warn'}`;
        
        // YouTube - ì±„ë„, ì˜ìƒ, ì¥ì†Œ ë§¤í•‘ ìˆ˜ í‘œì‹œ
        document.getElementById('youtube-count').innerHTML = `${data.youtube?.count || 0} ì±„ë„`;
        document.getElementById('youtube-videos').textContent = `${data.youtube?.videos || 0} ì˜ìƒ`;
        document.getElementById('youtube-places').textContent = `${data.youtube?.placeMentions || 0} ì¥ì†Œ`;
        document.getElementById('youtube-sync').textContent = data.youtube?.lastSync || '-';
        document.getElementById('youtube-status').textContent = data.youtube?.status || 'ëŒ€ê¸°';
        document.getElementById('youtube-status').className = `status-badge ${data.youtube?.status === 'í™œì„±' ? 'status-ok' : 'status-warn'}`;
        
        // Naver
        document.getElementById('naver-count').textContent = `${data.naver?.count || 0} ì†ŒìŠ¤`;
        document.getElementById('naver-sync').textContent = data.naver?.lastSync || '-';
        document.getElementById('naver-status').textContent = data.naver?.status || 'ëŒ€ê¸°';
        document.getElementById('naver-status').className = `status-badge ${data.naver?.status === 'í™œì„±' ? 'status-ok' : 'status-warn'}`;
        
        // Load hashtags and locations for sources tab
        loadSourcesInstagramData();
      } catch (err) {
        console.error('í†µí•© ì†ŒìŠ¤ ìƒíƒœ ë¡œë“œ ì˜¤ë¥˜:', err);
      }
    }
    
    async function loadSourcesInstagramData() {
      try {
        const [hashtagsRes, locationsRes] = await Promise.all([
          fetch(`${API_BASE}/instagram/hashtags`),
          fetch(`${API_BASE}/instagram/locations`)
        ]);
        const hashtags = await hashtagsRes.json();
        const locations = await locationsRes.json();
        
        const hashtagEl = document.getElementById('hashtag-list-sources');
        hashtagEl.innerHTML = hashtags.length ? hashtags.slice(0, 20).map(h => `
          <div class="service-item">
            <span>${h.hashtag}</span>
            <span style="font-size: 12px; color: #9ca3af;">${h.postCount ? h.postCount.toLocaleString() + 'ê°œ' : '-'}</span>
          </div>
        `).join('') : '<div class="empty-state">í•´ì‹œíƒœê·¸ê°€ ì—†ìŠµë‹ˆë‹¤</div>';
        
        const locationEl = document.getElementById('location-list-sources');
        locationEl.innerHTML = locations.length ? locations.slice(0, 20).map(l => `
          <div class="service-item">
            <span>${l.locationName}</span>
            <span style="font-size: 12px; color: #9ca3af;">${l.postCount ? l.postCount.toLocaleString() + 'ê°œ' : '-'}</span>
          </div>
        `).join('') : '<div class="empty-state">ìœ„ì¹˜ íƒœê·¸ê°€ ì—†ìŠµë‹ˆë‹¤</div>';
      } catch (err) {
        console.error('Instagram ë°ì´í„° ë¡œë“œ ì˜¤ë¥˜:', err);
      }
    }
    
    async function addHashtagFromSources() {
      const hashtag = document.getElementById('new-hashtag-sources').value;
      const category = document.getElementById('hashtag-category-sources').value;
      if (!hashtag) { alert('í•´ì‹œíƒœê·¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”'); return; }
      try {
        await fetch(`${API_BASE}/instagram/hashtags`, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ hashtag, category })
        });
        document.getElementById('new-hashtag-sources').value = '';
        loadSourcesInstagramData();
      } catch (err) { alert('ì¶”ê°€ ì‹¤íŒ¨'); }
    }
    
    async function addLocationFromSources() {
      const locationId = document.getElementById('new-location-id-sources').value;
      const locationName = document.getElementById('new-location-name-sources').value;
      if (!locationId || !locationName) { alert('ëª¨ë“  í•„ë“œë¥¼ ì…ë ¥í•˜ì„¸ìš”'); return; }
      try {
        await fetch(`${API_BASE}/instagram/locations`, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ locationId, locationName })
        });
        document.getElementById('new-location-id-sources').value = '';
        document.getElementById('new-location-name-sources').value = '';
        loadSourcesInstagramData();
      } catch (err) { alert('ì¶”ê°€ ì‹¤íŒ¨'); }
    }
    
    async function syncGooglePlaces() {
      alert('Google Places ë™ê¸°í™”ê°€ ì‹œì‘ë©ë‹ˆë‹¤. ì‹œê°„ì´ ê±¸ë¦´ ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
      try {
        await fetch('/api/sync/city/1/places', { method: 'POST' });
        loadUnifiedSourcesStatus();
      } catch (err) { alert('ë™ê¸°í™” ì‹¤íŒ¨'); }
    }
    
    async function syncNaverBlogs() {
      alert('ë„¤ì´ë²„ ë¸”ë¡œê·¸ í¬ë¡¤ëŸ¬ê°€ ì¤€ë¹„ ì¤‘ì…ë‹ˆë‹¤.');
    }
    
    async function loadApiDetail() {
      try {
        const el = document.getElementById('api-detail');
        el.innerHTML = '<div style="text-align: center; padding: 20px; color: #f59e0b;">ì‹¤ì‹œê°„ ì—°ê²° ìƒíƒœ í™•ì¸ ì¤‘...</div>';
        
        // ì‹¤ì‹œê°„ health check API í˜¸ì¶œ
        const healthRes = await fetch(`${API_BASE}/api-services/health`);
        const healthData = await healthRes.json();
        
        const serviceNames = {
          'google_places': 'Google Places API',
          'google_maps': 'Google Maps API',
          'openweather': 'OpenWeather API',
          'youtube_data': 'YouTube Data API',
          'exchange_rate': 'Exchange Rate API',
          'gemini': 'Gemini AI'
        };
        
        const services = Object.entries(healthData.services || {}).map(([name, health]) => ({
          serviceName: name,
          displayName: serviceNames[name] || name,
          isConnected: health.connected,
          latency: health.latency,
          error: health.error,
          lastChecked: health.lastChecked
        }));
        
        updateSystemStatusFromHealth(services);
        
        const serviceItems = services.map(s => {
          const statusClass = s.isConnected ? 'active' : (s.error === 'API key not configured' ? 'unconfigured' : 'inactive');
          const statusLabel = s.isConnected ? 'ì—°ê²°ë¨' : (s.error === 'API key not configured' ? 'í‚¤ ë¯¸ì„¤ì •' : 'ì—°ê²° ì˜¤ë¥˜');
          const lastChecked = s.lastChecked ? new Date(s.lastChecked).toLocaleString('ko-KR') : '-';
          
          return `
            <div class="service-item" style="flex-direction: column; align-items: stretch; gap: 8px;">
              <div style="display: flex; justify-content: space-between; align-items: center;">
                <span class="service-name">${s.displayName}</span>
                <div style="display: flex; gap: 12px; align-items: center;">
                  ${s.isConnected ? `<span style="font-size: 12px; color: #22c55e;">${s.latency}ms</span>` : ''}
                  <span class="service-status ${statusClass}" title="${statusLabel}"></span>
                </div>
              </div>
              <div style="font-size: 11px; color: #6b7280; display: flex; justify-content: space-between;">
                <span>ìƒíƒœ: <span style="color: ${s.isConnected ? '#22c55e' : '#ef4444'}">${statusLabel}</span></span>
                <span>í™•ì¸ ì‹œê°„: ${lastChecked}</span>
              </div>
              ${s.error && s.error !== 'API key not configured' ? `<div style="font-size: 11px; color: #ef4444;">ì˜¤ë¥˜: ${s.error}</div>` : ''}
            </div>
          `;
        }).join('');
        
        el.innerHTML = `
          <div>
            <h3 style="font-size: 14px; color: #a78bfa; margin-bottom: 12px;">ì„œë¹„ìŠ¤ ìƒíƒœ (ì‹¤ì‹œê°„)</h3>
            ${serviceItems || '<div class="empty-state">ì„œë¹„ìŠ¤ê°€ ì—†ìŠµë‹ˆë‹¤</div>'}
          </div>
        `;
      } catch (err) {
        console.error('API ìƒì„¸ ë¡œë“œ ì˜¤ë¥˜:', err);
        document.getElementById('api-detail').innerHTML = '<div style="color: #ef4444;">ìƒíƒœ í™•ì¸ ì‹¤íŒ¨</div>';
      }
    }
    
    function getStatusLabel(service) {
      if (!service.isConfigured) {
        return 'ë¯¸ì—°ê²°';
      }
      if (service.healthStatus) {
        switch (service.healthStatus.status) {
          case 'healthy': return 'ì •ìƒ';
          case 'warning': return 'ì£¼ì˜';
          case 'error': return 'ì˜¤ë¥˜';
          case 'unknown': return 'ì•Œ ìˆ˜ ì—†ìŒ';
          default: return 'ì•Œ ìˆ˜ ì—†ìŒ';
        }
      }
      return 'ì •ìƒ';
    }
    
    async function loadLogs() {
      try {
        const res = await fetch(`${API_BASE}/sync-logs?limit=100`);
        const logs = await res.json();
        
        const el = document.getElementById('sync-history');
        el.innerHTML = logs.length ? logs.map(l => `
          <div class="log-item">
            <span>${l.entityType} ${l.entityId ? `#${l.entityId}` : ''}</span>
            <span class="log-status ${l.status}">${STATUS_MAP[l.status] || l.status}</span>
            <span style="color: #6b7280;">${l.itemsProcessed || 0}ê°œ ì²˜ë¦¬</span>
            <span class="log-time">${new Date(l.startedAt).toLocaleString('ko-KR')}</span>
          </div>
        `).join('') : '<div class="empty-state">ë™ê¸°í™” ë¡œê·¸ê°€ ì—†ìŠµë‹ˆë‹¤</div>';
      } catch (err) {
        console.error('ë¡œê·¸ ë¡œë“œ ì˜¤ë¥˜:', err);
      }
    }
    
    async function initApiServices() {
      try {
        await fetch(`${API_BASE}/api-services/init`, { method: 'POST' });
        await fetch(`${API_BASE}/schedules/init`, { method: 'POST' });
        alert('ì„œë¹„ìŠ¤ê°€ ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤!');
        loadDashboard();
        loadApiDetail();
      } catch (err) {
        alert('ì„œë¹„ìŠ¤ ì´ˆê¸°í™”ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤');
      }
    }
    
    async function seedDefaultData() {
      try {
        const res = await fetch(`${API_BASE}/seed/defaults`, { method: 'POST' });
        const data = await res.json();
        alert(`ê¸°ë³¸ ë°ì´í„° ì…ë ¥ ì™„ë£Œ!\nìœ íŠœë¸Œ ì±„ë„: ${data.channelsAdded}ê°œ\në¸”ë¡œê·¸ ì†ŒìŠ¤: ${data.sourcesAdded}ê°œ`);
        loadSources();
        loadDashboard();
      } catch (err) {
        alert('ê¸°ë³¸ ë°ì´í„° ì…ë ¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤');
      }
    }
    
    async function seedCities() {
      try {
        const res = await fetch(`${API_BASE}/seed/cities`, { method: 'POST' });
        const data = await res.json();
        alert(`ê¸°ë³¸ ë„ì‹œ ë°ì´í„° ì…ë ¥ ì™„ë£Œ!\në„ì‹œ: ${data.citiesAdded}ê°œ`);
        loadDashboard();
      } catch (err) {
        alert('ë„ì‹œ ë°ì´í„° ì…ë ¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤');
      }
    }
    
    async function seedInstagramHashtags() {
      try {
        const res = await fetch(`${API_BASE}/seed/instagram`, { method: 'POST' });
        const data = await res.json();
        alert(`ê¸°ë³¸ í•´ì‹œíƒœê·¸ ì…ë ¥ ì™„ë£Œ!\ní•´ì‹œíƒœê·¸: ${data.hashtagsAdded}ê°œ`);
        loadInstagramData();
        loadDashboard();
      } catch (err) {
        alert('í•´ì‹œíƒœê·¸ ì…ë ¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤');
      }
    }
    
    async function syncExchangeRates() {
      const resultEl = document.getElementById('sync-result');
      resultEl.innerHTML = '<span style="color: #f59e0b;">í™˜ìœ¨ ë™ê¸°í™” ì¤‘...</span>';
      try {
        const res = await fetch(`${API_BASE}/sync/exchange-rates`, { method: 'POST' });
        const data = await res.json();
        if (res.ok) {
          resultEl.innerHTML = `<span style="color: #22c55e;">í™˜ìœ¨ ë™ê¸°í™” ì™„ë£Œ! ${data.synced}ê°œ í†µí™” ì—…ë°ì´íŠ¸ë¨</span>`;
          loadDashboard();
          loadLogs();
        } else {
          resultEl.innerHTML = `<span style="color: #ef4444;">ì˜¤ë¥˜: ${data.error}</span>`;
        }
      } catch (err) {
        resultEl.innerHTML = '<span style="color: #ef4444;">í™˜ìœ¨ ë™ê¸°í™”ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤</span>';
      }
    }
    
    async function syncYouTube() {
      const resultEl = document.getElementById('sync-result');
      resultEl.innerHTML = '<span style="color: #f59e0b;">ìœ íŠœë¸Œ ë™ê¸°í™” ì¤‘... (ì‹œê°„ì´ ê±¸ë¦´ ìˆ˜ ìˆìŠµë‹ˆë‹¤)</span>';
      try {
        const res = await fetch(`${API_BASE}/sync/youtube`, { method: 'POST' });
        const data = await res.json();
        if (res.ok) {
          resultEl.innerHTML = `<span style="color: #22c55e;">ìœ íŠœë¸Œ ë™ê¸°í™” ì™„ë£Œ! ${data.channelsSynced}ê°œ ì±„ë„, ${data.totalSynced}ê°œ ì˜ìƒ</span>`;
          loadSources();
          loadLogs();
        } else {
          if (data.needsKey) {
            resultEl.innerHTML = `<span style="color: #ef4444;">YouTube API í‚¤ í•„ìš”<br><small>${data.instructions}</small></span>`;
          } else {
            resultEl.innerHTML = `<span style="color: #ef4444;">ì˜¤ë¥˜: ${data.error}</span>`;
          }
        }
      } catch (err) {
        resultEl.innerHTML = '<span style="color: #ef4444;">ìœ íŠœë¸Œ ë™ê¸°í™”ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤</span>';
      }
    }
    
    async function syncPlaces() {
      const resultEl = document.getElementById('sync-result');
      resultEl.innerHTML = '<span style="color: #f59e0b;">ì¥ì†Œ ë™ê¸°í™” ì¤‘... (ì„œìš¸)</span>';
      try {
        const res = await fetch(`${API_BASE}/sync/places/1`, { method: 'POST' });
        const data = await res.json();
        if (res.ok) {
          resultEl.innerHTML = `<span style="color: #22c55e;">${data.message} - ${data.synced}ê°œ ì¥ì†Œ ìˆ˜ì§‘ë¨</span>`;
          loadDashboard();
          loadLogs();
        } else {
          resultEl.innerHTML = `<span style="color: #ef4444;">ì˜¤ë¥˜: ${data.error}</span>`;
        }
      } catch (err) {
        resultEl.innerHTML = '<span style="color: #ef4444;">ì¥ì†Œ ë™ê¸°í™”ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤</span>';
      }
    }
    
    async function loadApiRealStatus() {
      try {
        const res = await fetch(`${API_BASE}/api-status`);
        const status = await res.json();
        const el = document.getElementById('api-real-status');
        el.innerHTML = `
          <div style="display: grid; gap: 8px;">
            <div>Google Places: <span style="color: ${status.googlePlaces.configured ? '#22c55e' : '#f59e0b'}">${status.googlePlaces.message}</span></div>
            <div>YouTube: <span style="color: ${status.youtube.configured ? '#22c55e' : '#f59e0b'}">${status.youtube.message}</span></div>
            <div>Gemini AI: <span style="color: ${status.gemini.configured ? '#22c55e' : '#f59e0b'}">${status.gemini.message}</span></div>
            <div>í™˜ìœ¨: <span style="color: ${status.exchangeRate.configured ? '#22c55e' : '#f59e0b'}">${status.exchangeRate.message}</span></div>
            <div>ë‚ ì”¨: <span style="color: ${status.openWeather?.configured ? '#22c55e' : '#f59e0b'}">${status.openWeather?.message || 'ë¯¸ì„¤ì •'}</span></div>
          </div>
        `;
      } catch (err) {
        console.error('API ìƒíƒœ ë¡œë“œ ì˜¤ë¥˜:', err);
      }
    }
    
    function toggleForm(id) {
      document.getElementById(id).classList.toggle('active');
    }

    async function loadInstagram() {
      try {
        const [statsRes, hashtagsRes, locationsRes] = await Promise.all([
          fetch(`${API_BASE}/instagram/stats`),
          fetch(`${API_BASE}/instagram/hashtags`),
          fetch(`${API_BASE}/instagram/locations`)
        ]);
        
        const stats = await statsRes.json();
        const hashtags = await hashtagsRes.json();
        const locations = await locationsRes.json();
        
        document.getElementById('stat-hashtags').textContent = stats.totalHashtags;
        document.getElementById('stat-locations').textContent = stats.totalLocations;
        document.getElementById('stat-photos').textContent = stats.totalPhotos;
        document.getElementById('stat-ig-sync').textContent = stats.lastSyncAt 
          ? new Date(stats.lastSyncAt).toLocaleDateString('ko-KR')
          : '-';
        
        const hashtagList = document.getElementById('hashtag-list');
        hashtagList.innerHTML = hashtags.length ? hashtags.map(h => `
          <div class="service-item">
            <div>
              <span style="font-weight: 600;">${h.hashtag}</span>
              <span style="color: #6b7280; font-size: 12px; margin-left: 8px;">
                ${h.postCount ? h.postCount.toLocaleString() + 'ê°œ' : 'ë¯¸ìˆ˜ì§‘'}
              </span>
              ${h.category ? `<span style="color: #a78bfa; font-size: 11px; margin-left: 8px;">${h.category}</span>` : ''}
            </div>
            <div style="display: flex; gap: 8px;">
              <button class="btn btn-sm btn-secondary" onclick="syncHashtag(${h.id})">ë™ê¸°í™”</button>
              <button class="btn btn-sm" style="background: rgba(239,68,68,0.2); color: #ef4444;" onclick="deleteHashtag(${h.id})">ì‚­ì œ</button>
            </div>
          </div>
        `).join('') : '<div class="empty-state">ë“±ë¡ëœ í•´ì‹œíƒœê·¸ê°€ ì—†ìŠµë‹ˆë‹¤</div>';
        
        const locationList = document.getElementById('location-list');
        locationList.innerHTML = locations.length ? locations.map(l => `
          <div class="service-item">
            <div>
              <span style="font-weight: 600;">${l.locationName}</span>
              <span style="color: #6b7280; font-size: 12px; margin-left: 8px;">
                ${l.postCount ? l.postCount.toLocaleString() + 'ê°œ' : 'ë¯¸ìˆ˜ì§‘'}
              </span>
            </div>
            <div style="display: flex; gap: 8px;">
              <button class="btn btn-sm btn-secondary" onclick="syncLocation(${l.id})">ë™ê¸°í™”</button>
              <button class="btn btn-sm" style="background: rgba(239,68,68,0.2); color: #ef4444;" onclick="deleteLocation(${l.id})">ì‚­ì œ</button>
            </div>
          </div>
        `).join('') : '<div class="empty-state">ë“±ë¡ëœ ìœ„ì¹˜ê°€ ì—†ìŠµë‹ˆë‹¤</div>';
        
      } catch (err) {
        console.error('Instagram ë°ì´í„° ë¡œë“œ ì˜¤ë¥˜:', err);
      }
    }
    
    async function addHashtag() {
      const hashtag = document.getElementById('new-hashtag').value;
      const category = document.getElementById('hashtag-category').value;
      
      if (!hashtag) {
        alert('í•´ì‹œíƒœê·¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”');
        return;
      }
      
      try {
        const res = await fetch(`${API_BASE}/instagram/hashtags`, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ hashtag, category })
        });
        if (res.ok) {
          document.getElementById('new-hashtag').value = '';
          toggleForm('hashtag-form');
          loadInstagram();
        } else {
          const err = await res.json();
          alert(err.error || 'ì¶”ê°€ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤');
        }
      } catch (err) {
        alert('ì¶”ê°€ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤');
      }
    }
    
    async function deleteHashtag(id) {
      if (!confirm('ì´ í•´ì‹œíƒœê·¸ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) return;
      try {
        await fetch(`${API_BASE}/instagram/hashtags/${id}`, { method: 'DELETE' });
        loadInstagram();
      } catch (err) {
        alert('ì‚­ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤');
      }
    }
    
    async function syncHashtag(id) {
      try {
        const res = await fetch(`${API_BASE}/instagram/hashtags/${id}/sync`, { method: 'POST' });
        const data = await res.json();
        if (data.success) {
          alert(`ë™ê¸°í™” ì™„ë£Œ: ${data.postCount?.toLocaleString() || 0}ê°œ ê²Œì‹œë¬¼`);
          loadInstagram();
        } else {
          alert('ë™ê¸°í™” ì‹¤íŒ¨ (Instagram ì ‘ê·¼ ì œí•œ ê°€ëŠ¥)');
        }
      } catch (err) {
        alert('ë™ê¸°í™”ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤');
      }
    }
    
    async function addLocation() {
      const locationId = document.getElementById('new-location-id').value;
      const locationName = document.getElementById('new-location-name').value;
      
      if (!locationId || !locationName) {
        alert('ìœ„ì¹˜ IDì™€ ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”');
        return;
      }
      
      try {
        const res = await fetch(`${API_BASE}/instagram/locations`, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ locationId, locationName })
        });
        if (res.ok) {
          document.getElementById('new-location-id').value = '';
          document.getElementById('new-location-name').value = '';
          toggleForm('location-form');
          loadInstagram();
        } else {
          const err = await res.json();
          alert(err.error || 'ì¶”ê°€ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤');
        }
      } catch (err) {
        alert('ì¶”ê°€ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤');
      }
    }
    
    async function deleteLocation(id) {
      if (!confirm('ì´ ìœ„ì¹˜ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) return;
      try {
        await fetch(`${API_BASE}/instagram/locations/${id}`, { method: 'DELETE' });
        loadInstagram();
      } catch (err) {
        alert('ì‚­ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤');
      }
    }
    
    async function syncLocation(id) {
      try {
        const res = await fetch(`${API_BASE}/instagram/locations/${id}/sync`, { method: 'POST' });
        const data = await res.json();
        if (data.success) {
          alert(`ë™ê¸°í™” ì™„ë£Œ: ${data.postCount?.toLocaleString() || 0}ê°œ ê²Œì‹œë¬¼`);
          loadInstagram();
        } else {
          alert('ë™ê¸°í™” ì‹¤íŒ¨ (Instagram ì ‘ê·¼ ì œí•œ ê°€ëŠ¥)');
        }
      } catch (err) {
        alert('ë™ê¸°í™”ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤');
      }
    }
    
    async function seedInstagramData() {
      try {
        const res = await fetch(`${API_BASE}/instagram/seed`, { method: 'POST' });
        const data = await res.json();
        alert(data.message);
        loadInstagram();
      } catch (err) {
        alert('ê¸°ë³¸ ë°ì´í„° ì¶”ê°€ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤');
      }
    }
    
    async function syncAllInstagram() {
      if (!confirm('ì „ì²´ Instagram ë°ì´í„°ë¥¼ ë™ê¸°í™”í•˜ì‹œê² ìŠµë‹ˆê¹Œ? (ì‹œê°„ì´ ê±¸ë¦´ ìˆ˜ ìˆìŠµë‹ˆë‹¤)')) return;
      try {
        const res = await fetch(`${API_BASE}/instagram/sync-all`, { method: 'POST' });
        const data = await res.json();
        alert(`ë™ê¸°í™” ì™„ë£Œ:\ní•´ì‹œíƒœê·¸: ${data.hashtags.synced}ê°œ ì„±ê³µ, ${data.hashtags.failed}ê°œ ì‹¤íŒ¨\nìœ„ì¹˜: ${data.locations.synced}ê°œ ì„±ê³µ, ${data.locations.failed}ê°œ ì‹¤íŒ¨`);
        loadInstagram();
      } catch (err) {
        alert('ì „ì²´ ë™ê¸°í™”ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤');
      }
    }
    
    async function addYoutubeChannel() {
      const data = {
        channelId: document.getElementById('yt-channel-id').value,
        channelName: document.getElementById('yt-channel-name').value,
        category: document.getElementById('yt-category').value,
        trustWeight: parseFloat(document.getElementById('yt-trust').value) || 1.0
      };
      
      if (!data.channelId || !data.channelName) {
        alert('ì±„ë„ IDì™€ ì´ë¦„ì€ í•„ìˆ˜ì…ë‹ˆë‹¤');
        return;
      }
      
      try {
        const res = await fetch(`${API_BASE}/youtube-channels`, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(data)
        });
        if (res.ok) {
          toggleForm('yt-form');
          loadSources();
        } else {
          const err = await res.json();
          alert(err.error || 'ì±„ë„ ì¶”ê°€ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤');
        }
      } catch (err) {
        alert('ì±„ë„ ì¶”ê°€ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤');
      }
    }
    
    async function addBlogSource() {
      const data = {
        platform: document.getElementById('blog-platform').value,
        sourceName: document.getElementById('blog-name').value,
        sourceUrl: document.getElementById('blog-url').value,
        trustWeight: parseFloat(document.getElementById('blog-trust').value) || 1.0
      };
      
      if (!data.platform || !data.sourceName) {
        alert('í”Œë«í¼ê³¼ ì´ë¦„ì€ í•„ìˆ˜ì…ë‹ˆë‹¤');
        return;
      }
      
      try {
        const res = await fetch(`${API_BASE}/blog-sources`, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(data)
        });
        if (res.ok) {
          toggleForm('blog-form');
          loadSources();
        } else {
          const err = await res.json();
          alert(err.error || 'ì†ŒìŠ¤ ì¶”ê°€ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤');
        }
      } catch (err) {
        alert('ì†ŒìŠ¤ ì¶”ê°€ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤');
      }
    }
    
    loadDashboard();
    
    // ê°€ì´ë“œ ê°€ê²© ê´€ë ¨ í•¨ìˆ˜
    async function loadGuidePrices() {
      const container = document.getElementById('guide-prices-list');
      try {
        const res = await fetch(`${API_BASE}/guide-prices`);
        const prices = await res.json();
        
        if (prices.length === 0) {
          container.innerHTML = `
            <div style="text-align: center; padding: 40px; color: #6b7280;">
              <p>ê°€ê²© ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤</p>
              <button class="btn btn-primary" onclick="seedGuidePrices()" style="margin-top: 16px;">ê¸°ë³¸ ê°€ê²© ì…ë ¥</button>
            </div>`;
          return;
        }
        
        container.innerHTML = prices.map(p => `
          <div class="service-item" style="display: grid; grid-template-columns: 1fr auto auto; align-items: center; gap: 16px;">
            <div>
              <div style="font-weight: 600; font-size: 15px;">${p.serviceName}</div>
              <div style="font-size: 12px; color: #9ca3af; margin-top: 2px;">${p.description || ''}</div>
              <div style="font-size: 11px; color: #6b7280; margin-top: 4px;">
                ${p.features ? p.features.map(f => `<span style="background: rgba(255,255,255,0.05); padding: 2px 8px; border-radius: 4px; margin-right: 4px;">${f}</span>`).join('') : ''}
              </div>
            </div>
            <div style="text-align: right;">
              <div style="font-size: 20px; font-weight: 700; color: #a78bfa;">
                ${p.pricePerDay ? `â‚¬${p.pricePerDay}` : `â‚¬${p.priceLow}~${p.priceHigh}`}
              </div>
              <div style="font-size: 11px; color: #6b7280;">${p.unit === 'day' ? '/ì¼' : '/íšŒ'}</div>
            </div>
            <button class="btn btn-secondary" onclick='openEditModal(${JSON.stringify(p)})' style="padding: 8px 16px;">ìˆ˜ì •</button>
          </div>
        `).join('');
      } catch (err) {
        container.innerHTML = `<div style="color: #ef4444;">ê°€ê²© ë¡œë”© ì‹¤íŒ¨: ${err.message}</div>`;
      }
    }
    
    function openEditModal(price) {
      document.getElementById('edit-price-id').value = price.id;
      document.getElementById('edit-service-name').textContent = price.serviceName;
      document.getElementById('edit-price-per-day').value = price.pricePerDay || '';
      document.getElementById('edit-price-low').value = price.priceLow || '';
      document.getElementById('edit-price-high').value = price.priceHigh || '';
      document.getElementById('edit-description').value = price.description || '';
      document.getElementById('guide-price-edit-modal').style.display = 'flex';
    }
    
    function closeEditModal() {
      document.getElementById('guide-price-edit-modal').style.display = 'none';
    }
    
    document.getElementById('guide-price-form').addEventListener('submit', async (e) => {
      e.preventDefault();
      const id = document.getElementById('edit-price-id').value;
      const data = {
        pricePerDay: parseFloat(document.getElementById('edit-price-per-day').value) || null,
        priceLow: parseFloat(document.getElementById('edit-price-low').value) || null,
        priceHigh: parseFloat(document.getElementById('edit-price-high').value) || null,
        description: document.getElementById('edit-description').value
      };
      
      try {
        const res = await fetch(`${API_BASE}/guide-prices/${id}`, {
          method: 'PUT',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(data)
        });
        if (res.ok) {
          closeEditModal();
          loadGuidePrices();
        } else {
          alert('ì €ì¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤');
        }
      } catch (err) {
        alert('ì €ì¥ ì¤‘ ì˜¤ë¥˜: ' + err.message);
      }
    });
    
    async function seedGuidePrices() {
      try {
        const res = await fetch(`${API_BASE}/guide-prices/seed`, { method: 'POST' });
        const data = await res.json();
        if (data.success) {
          alert(`${data.count}ê°œ ê°€ê²© ë°ì´í„°ê°€ ì…ë ¥ë˜ì—ˆìŠµë‹ˆë‹¤`);
          loadGuidePrices();
        }
      } catch (err) {
        alert('ì‹œë“œ ë°ì´í„° ì…ë ¥ ì‹¤íŒ¨');
      }
    }
    
    let autoRefreshInterval = null;
    let lastUpdateTime = new Date();
    
    function updateRefreshTime() {
      const el = document.getElementById('last-update');
      if (el) {
        el.textContent = `ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸: ${lastUpdateTime.toLocaleTimeString('ko-KR')}`;
      }
    }
    
    async function refreshAll() {
      const activeTab = document.querySelector('.tab.active')?.dataset.tab || 'overview';
      await loadTabData(activeTab);
      lastUpdateTime = new Date();
      updateRefreshTime();
    }
    
    function startAutoRefresh() {
      if (autoRefreshInterval) clearInterval(autoRefreshInterval);
      autoRefreshInterval = setInterval(refreshAll, 30000);
      console.log('ìë™ ìƒˆë¡œê³ ì¹¨ ì‹œì‘ (30ì´ˆ ê°„ê²©)');
    }
    
    function stopAutoRefresh() {
      if (autoRefreshInterval) {
        clearInterval(autoRefreshInterval);
        autoRefreshInterval = null;
        console.log('ìë™ ìƒˆë¡œê³ ì¹¨ ì¤‘ì§€');
      }
    }
    
    startAutoRefresh();
    
    document.addEventListener('visibilitychange', () => {
      if (document.hidden) {
        stopAutoRefresh();
      } else {
        refreshAll();
        startAutoRefresh();
      }
    });
  </script>
</body>
</html>
